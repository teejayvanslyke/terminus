<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: abstract_controller.rb</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>abstract_controller.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>lib/merb-core/controller/abstract_controller.rb
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Mon Aug 18 22:35:53 +0200 2008</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h4>Why do we use Underscores?</h4>
<p>
In <a href="../../../../classes/Merb.html">Merb</a>, views are actually
methods on controllers. This provides not-insignificant speed benefits, as
well as preventing us from needing to copy over instance variables, which
we think is proof that everything belongs in one class to begin with.
</p>
<p>
Unfortunately, this means that view helpers need to be included into the
&lt;strong&gt;Controller&lt;/strong&gt; class. To avoid causing confusion
when your helpers potentially conflict with our instance methods, we use an
_ to disambiguate. As long as you don&#8216;t begin your helper methods
with _, you only need to worry about conflicts with <a
href="../../../../classes/Merb.html">Merb</a> methods that are part of the
public API.
</p>
<h4>Filters</h4>
<p>
before is a class method that allows you to specify before filters in your
controllers. Filters can either be a symbol or string that corresponds to a
method name to call, or a proc object. if it is a method name that method
will be called and if it is a proc it will be called with an argument of
self where self is the current controller object. When you use a proc as a
filter it needs to take one parameter.
</p>
<p>
after is identical, but the filters are run after the action is invoked.
</p>
<h5>Examples</h5>
<pre>
  before :some_filter
  before :authenticate, :exclude =&gt; [:login, :signup]
  before :has_role, :with =&gt; [&quot;Admin&quot;], :exclude =&gt; [:index,:show]
  before Proc.new {|c| c.some_method }, :only =&gt; :foo
  before :authorize, :unless =&gt; logged_in?
</pre>
<p>
You can use either :only =&gt; :actionname or :exclude =&gt; [:this, :that]
but not both at once. :only will only run before the listed actions and
:exclude will run for every action that is not listed.
</p>
<p>
<a href="../../../../classes/Merb.html">Merb</a>&#8216;s before filter
chain is very flexible. To halt the filter chain you use throw :halt. If
throw is called with only one argument of :halt the return of the method
filters_halted will be what is rendered to the view. You can overide
filters_halted in your own controllers to control what it outputs. But the
throw construct is much more powerful then just that. throw :halt can also
take a second argument. Here is what that second arg can be and the
behavior each type can have:
</p>
<ul>
<li><tt><a href="../../../../classes/String.html">String</a></tt>: when the
second arg is a string then that string will be what is rendered to the
browser. Since merb&#8216;s render method returns a string you can render a
template or just use a plain string:

<pre>
  throw :halt, &quot;You don't have permissions to do that!&quot;
  throw :halt, render(:action =&gt; :access_denied)
</pre>
</li>
<li><tt>Symbol</tt>: If the second arg is a symbol then the method named after
that symbol will be called

<p>
throw :halt, :must_click_disclaimer
</p>
</li>
<li><tt>Proc</tt>:

<p>
If the second arg is a Proc, it will be called and its return value will be
what is rendered to the browser:
</p>
<pre>
  throw :halt, proc {|c| c.access_denied }
  throw :halt, proc {|c| Tidy.new(c.index) }
</pre>
</li>
</ul>
<h5>Filter Options (.before, .after, .add_filter, .if, .unless)</h5>
<table>
<tr><td valign="top">:only&lt;Symbol, Array[Symbol]&gt;:</td><td>A list of actions that this filter should apply to

</td></tr>
<tr><td valign="top">:exclude&lt;Symbol, Array[Symbol]:</td><td>A list of actions that this filter should <b>not</b> apply to

</td></tr>
<tr><td valign="top">:if&lt;Symbol, Proc&gt;:</td><td>Only apply the filter if the method named after the symbol or calling the
proc evaluates to true

</td></tr>
<tr><td valign="top">:unless&lt;Symbol, Proc&gt;:</td><td>Only apply the filter if the method named after the symbol or calling the
proc evaluates to false

</td></tr>
<tr><td valign="top">:with&lt;Array[<a href="../../../../classes/Object.html">Object</a>]&gt;:</td><td>Arguments to be passed to the filter. Since we are talking method/proc
calls, filter method or Proc should to have the same arity as number of
elements in Array you pass to this option.

</td></tr>
</table>
<h5>Types (shortcuts for use in this file)</h5>
<table>
<tr><td valign="top">Filter:</td><td>&lt;Array[Symbol, (Symbol, <a
href="../../../../classes/String.html">String</a>, Proc)]&gt;

</td></tr>
</table>
<h4>params[:action] and params[:controller] deprecated</h4>
<p>
params[:action] and params[:controller] have been deprecated as of the
0.9.0 release. They are no longer set during dispatch, and have been
replaced by action_name and controller_name respectively.
</p>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>